<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" th:content="${therapist != null ? 'View profile of ' + therapist.firstName + ' ' + therapist.lastName + ' at HealingTouch' : 'Therapist Profile'}">
    <title th:text="${therapist != null ? therapist.firstName + ' ' + therapist.lastName + ' | HealingTouch' : 'Therapist Profile | HealingTouch'}">
        Therapist Profile | HealingTouch
    </title>
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- AOS (Animate On Scroll) CSS -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    
    <!-- Custom CSS -->
    <link th:href="@{/css/style.css}" rel="stylesheet">
    
    <style>
        :root {
            --spa-green: #6b8e6b;
            --spa-green-dark: #4a7c59;
            --spa-beige: #f5f5dc;
            --spa-cream: #faf5e6;
            --spa-sand: #d4c5a0;
        }
        
        body {
            background: linear-gradient(135deg, var(--spa-cream) 0%, var(--spa-beige) 50%, #fff8e7 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        main {
            flex: 1;
            padding: 3rem 0;
        }
        
        .therapist-header {
            background: white;
            border-radius: 15px;
            padding: 3rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(107, 142, 107, 0.2);
        }
        
        .profile-image {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            object-fit: cover;
            border: 5px solid var(--spa-green);
            box-shadow: 0 4px 15px rgba(107, 142, 107, 0.3);
        }
        
        .status-badge {
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: inline-block;
        }
        
        .status-active {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status-unavailable {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .info-card {
            background: white;
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(107, 142, 107, 0.2);
        }
        
        .section-title {
            color: var(--spa-green-dark);
            font-weight: 600;
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
            padding-bottom: 0.75rem;
            border-bottom: 2px solid var(--spa-green);
        }
        
        .skill-tag {
            background: var(--spa-beige);
            color: var(--spa-green-dark);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.9rem;
            margin: 0.25rem;
            display: inline-block;
            border: 1px solid rgba(107, 142, 107, 0.3);
        }
        
        .info-row {
            display: flex;
            justify-content: space-between;
            padding: 1rem;
            margin: 0.5rem 0;
            background: var(--spa-cream);
            border-radius: 8px;
        }
        
        .info-label {
            color: #666;
            font-weight: 500;
        }
        
        .info-value {
            color: var(--spa-green-dark);
            font-weight: 600;
        }
        
        .review-card {
            background: var(--spa-cream);
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border-left: 4px solid var(--spa-green);
        }
        
        .review-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .review-rating {
            color: #ffc107;
        }
        
        .review-date {
            color: #888;
            font-size: 0.9rem;
        }
        
        .review-comment {
            color: #555;
            line-height: 1.7;
        }
        
        .average-rating {
            text-align: center;
            padding: 1.5rem;
            background: var(--spa-beige);
            border-radius: 10px;
            margin-bottom: 2rem;
        }
        
        .average-rating-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--spa-green-dark);
        }
        
        .book-btn {
            background: linear-gradient(135deg, var(--spa-green) 0%, var(--spa-green-dark) 100%);
            color: white;
            padding: 1rem 2.5rem;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 600;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            display: inline-block;
            box-shadow: 0 4px 15px rgba(107, 142, 107, 0.3);
        }
        
        .book-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 25px rgba(107, 142, 107, 0.4);
            color: white;
        }
        
        .empty-state {
            text-align: center;
            padding: 3rem;
            color: #666;
        }
        
        .empty-state i {
            font-size: 4rem;
            color: var(--spa-green);
            opacity: 0.4;
            margin-bottom: 1rem;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div th:replace="~{fragments/header :: header}"></div>
    
    <main>
        <div class="container" th:if="${therapist != null}">
            <!-- Therapist Header -->
            <div class="therapist-header" data-aos="fade-up" data-aos-duration="1000" data-aos-easing="ease-out-cubic">
                <div class="row align-items-center">
                    <div class="col-md-4 text-center mb-4 mb-md-0">
                        <img th:src="${therapist.profilePicture != null ? therapist.profilePicture : '/images/default-therapist.jpg'}" 
                             th:alt="${'Photo of ' + therapist.firstName + ' ' + therapist.lastName}"
                             class="profile-image">
                    </div>
                    <div class="col-md-8">
                        <h1 th:text="${therapist.firstName + ' ' + therapist.lastName}" 
                            style="color: var(--spa-green-dark); font-weight: 600; margin-bottom: 1rem;">
                            Therapist Name
                        </h1>
                        <span class="status-badge mb-3" 
                              th:classappend="${therapist.active == true ? 'status-active' : 'status-unavailable'}"
                              th:text="${therapist.active == true ? 'Active' : 'Unavailable'}"
                              th:if="${therapist.active != null}">
                            Status
                        </span>
                        <div class="mt-4">
                            <a th:href="@{'/bookings/new?therapistId=' + ${therapist.id}}" class="book-btn">
                                <i class="fas fa-calendar-check me-2"></i>Book a Session with This Therapist
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Skills Section -->
            <div class="info-card" th:if="${therapist.skills != null and !therapist.skills.isEmpty()}" 
                 data-aos="fade-up" data-aos-duration="800" data-aos-delay="100" data-aos-easing="ease-out-cubic">
                <h2 class="section-title">
                    <i class="fas fa-star me-2"></i>Skills
                </h2>
                <div>
                    <span class="skill-tag" th:each="skill : ${therapist.skills}" th:text="${skill}">
                        Skill
                    </span>
                </div>
            </div>
            
            <!-- Experience & Rate Section -->
            <div class="info-card" data-aos="fade-up" data-aos-duration="800" data-aos-delay="200" data-aos-easing="ease-out-cubic">
                <h2 class="section-title">
                    <i class="fas fa-info-circle me-2"></i>Details
                </h2>
                <div class="info-row">
                    <span class="info-label">
                        <i class="fas fa-clock me-2"></i>Experience
                    </span>
                    <span class="info-value" th:text="${therapist.experienceYears != null ? therapist.experienceYears + ' years' : 'N/A'}">
                        5 years
                    </span>
                </div>
                <div class="info-row" th:if="${therapist.hourlyRate != null}">
                    <span class="info-label">
                        <i class="fas fa-dollar-sign me-2"></i>Hourly Rate
                    </span>
                    <span class="info-value" th:text="${'$' + #numbers.formatDecimal(therapist.hourlyRate, 1, 2)}">
                        $50.00
                    </span>
                </div>
            </div>
            
            <!-- Reviews Section -->
            <div class="info-card" data-aos="fade-up" data-aos-duration="800" data-aos-delay="300" data-aos-easing="ease-out-cubic">
                <h2 class="section-title">
                    <i class="fas fa-comments me-2"></i>Reviews
                </h2>
                
                <!-- Average Rating -->
                <div class="average-rating" th:if="${reviews != null and !reviews.isEmpty()}">
                    <div class="average-rating-value" th:text="${#numbers.formatDecimal((#lists.size(reviews) > 0 ? #aggregates.avg(reviews.![rating]) : 0), 1, 1)}">
                        4.5
                    </div>
                    <div class="review-rating">
                        <i class="fas fa-star" th:each="i : ${#numbers.sequence(1, 5)}"></i>
                    </div>
                    <p style="color: #666; margin-top: 0.5rem; margin-bottom: 0;">
                        Based on <span th:text="${#lists.size(reviews)}">0</span> review<span th:text="${#lists.size(reviews) != 1 ? 's' : ''}">s</span>
                    </p>
                </div>
                
                <!-- Reviews List -->
                <div th:if="${reviews != null and !reviews.isEmpty()}">
                    <div class="review-card" th:each="review : ${reviews}">
                        <div class="review-header">
                            <div class="review-rating">
                                <i class="fas fa-star" th:each="i : ${#numbers.sequence(1, review.rating)}"></i>
                                <i class="far fa-star" th:each="i : ${#numbers.sequence(review.rating + 1, 5)}"></i>
                                <span class="ms-2" th:text="${review.rating}">5</span>
                            </div>
                            <div class="review-date" th:text="${review.createdOn != null ? #temporals.format(review.createdOn, 'MMM dd, yyyy') : 'N/A'}">
                                Date
                            </div>
                        </div>
                        <p class="review-comment" th:text="${review.comment != null ? review.comment : 'No comment provided.'}">
                            Review comment text...
                        </p>
                    </div>
                </div>
                
                <!-- No Reviews Message -->
                <div class="empty-state" th:if="${reviews == null or reviews.isEmpty()}">
                    <i class="fas fa-comment-slash"></i>
                    <h4 style="color: var(--spa-green-dark);">No Reviews Yet</h4>
                    <p>This therapist hasn't received any reviews yet. Be the first to share your experience!</p>
                </div>
            </div>
        </div>
        
        <!-- Therapist Not Found -->
        <div class="container" th:if="${therapist == null}">
            <div class="empty-state">
                <i class="fas fa-user-slash"></i>
                <h3 style="color: var(--spa-green-dark);">Therapist Not Found</h3>
                <p>The therapist you're looking for doesn't exist or has been removed.</p>
                <a th:href="@{/therapists}" class="book-btn mt-3">
                    <i class="fas fa-arrow-left me-2"></i>Back to Therapists
                </a>
            </div>
        </div>
    </main>
    
    <!-- Footer -->
    <div th:replace="~{fragments/footer :: footer}"></div>
    
    <!-- Bootstrap 5 JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- AOS (Animate On Scroll) JS -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script>
        AOS.init({
            duration: 800,
            easing: 'ease-out-cubic',
            once: true,
            offset: 80,
            delay: 0,
            disable: 'mobile'
        });
    </script>
</body>
</html>

